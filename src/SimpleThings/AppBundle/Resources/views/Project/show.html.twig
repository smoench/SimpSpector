{% extends 'SimpleThingsAppBundle::layout.html.twig' %}

{% block content %}
    <div class="row">
        <div class="column wide sixteen">
            <div class="ui steps">
                <a class="step" href="{{ path('homepage') }}">
                    <div class="content">
                        <div class="title"><i class="icon home"></i> Home</div>
                        <div class="description">... where the <i class="icon heart"></i> is</div>
                    </div>
                </a>
                <a class="step active">
                    <div class="content">
                        <div class="title"><i class="icon cubes"></i> Project</div>
                        <div class="description">{{ project.name }}</div>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="column wide sixteen">
            <div class="ui segment">
                <h3 class="ui header">
                    <i class="icon alternate sitemap inverted circular"></i>
                    Master
                </h3>
                <table class="ui table">
                    <thead>
                    <tr>
                        <th>&nbsp;</th>
                        <th>id</th>
                        <th>revision</th>
                        <th>issues</th>
                        <th>status</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for commit in masterCommits %}
                        <tr>
                            <td>
                                <a class="ui animated button" href="{{ path('commit_show', {id: commit.id}) }}">
                                    <div class="hidden content">show</div>
                                    <div class="visible content">
                                        <i class="search icon"></i>
                                    </div>
                                </a>
                            </td>
                            <td>
                                {{ commit.id }}
                            </td>
                            <td>{{ commit.revision }}</td>
                            <td>{{ commit.issues|length }}</td>
                            <td>
                                {% if commit.status == constant('STATUS_NEW', commit) %}
                                    <span class="ui label">New</span>
                                {% elseif commit.status == constant('STATUS_RUN', commit) %}
                                    <span class="ui yellow label">Proccess</span>
                                {% elseif commit.status == constant('STATUS_SUCCESS', commit) %}
                                    <span class="ui green label">Success</span>
                                {% else %}
                                    <span class="ui red label">Error</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

                <a href="{{ path('project_master', {id: project.id}) }}">See more</a>
            </div>

            <div class="ui segment">
                <h3 class="ui header">
                    <i class="icon alternate share inverted circular"></i> MergeRequests
                </h3>
                <table class="ui table">
                    <thead>
                    <tr>
                        <th>&nbsp;</th>
                        <th>id</th>
                        <th>title</th>
                        <th>issues</th>
                        <th>status</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for merge_request in merge_requests %}
                        <tr>
                            <td>
                                <a class="ui animated button"
                                   href="{{ path('mergerequest_show', {id: merge_request.id}) }}">
                                    <div class="hidden content">show</div>
                                    <div class="visible content">
                                        <i class="search icon"></i>
                                    </div>
                                </a>
                            </td>
                            <td>
                                {{ merge_request.id }}
                            </td>
                            <td>{{ merge_request.name }}</td>
                            <td>{{ (merge_request.commits|last).issues|length }}</td>
                            <td>
                                {% if merge_request.status == constant('STATUS_OPEN', merge_request) %}
                                    <span class="ui green label">Open</span>
                                {% elseif merge_request.status == constant('STATUS_MERGED', merge_request) %}
                                    <span class="ui purple label">Merged</span>
                                {% else %}
                                    <span class="ui red label">Closed</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}
